(function(window){"use strict";function BS5FormValidator(formSelector,options){this.form=document.querySelector(formSelector);this.options=options||{};this.fields=this.options.fields||{};if(!this.form){console.error("BS5FormValidator: Form not found for selector "+formSelector);return}this.init()}BS5FormValidator.prototype.init=function(){var self=this;this.form.setAttribute("novalidate",true);this.form.addEventListener("submit",function(e){self.validate(e)});this.form.addEventListener("input",function(e){self.handleInput(e)})};BS5FormValidator.prototype.handleInput=function(e){var input=e.target;var fieldName=input.getAttribute("name");if(!this.fields[fieldName])return;if(input.classList.contains("is-invalid")){var fieldConfig=this.fields[fieldName];var valid=fieldConfig.test(input.value);if(valid){this.clearError(input)}}};BS5FormValidator.prototype.validate=function(e){var self=this;var isValid=true;var errors={};var values={};var elements=this.form.querySelectorAll("[name]");for(var i=0;i<elements.length;i++){var el=elements[i];var name=el.getAttribute("name");var type=el.getAttribute("type");if(type==="radio"){if(el.checked){values[name]=el.value}}else if(type==="checkbox"){if(!values.hasOwnProperty(name)){var checkboxes=self.form.querySelectorAll('[name="'+name+'"]');if(checkboxes.length>1){var checked=[];for(var j=0;j<checkboxes.length;j++){if(checkboxes[j].checked)checked.push(checkboxes[j].value)}values[name]=checked}else{values[name]=el.checked}}}else{values[name]=el.value}}for(var fieldName in this.fields){if(this.fields.hasOwnProperty(fieldName)){var fieldConfig=this.fields[fieldName];var input=this.form.querySelector('[name="'+fieldName+'"]');if(!input)continue;var value=input.value;var valid=fieldConfig.test(value);if(!valid){isValid=false;errors[fieldName]=fieldConfig.error_message;self.showError(input,fieldConfig.error_message)}else{self.clearError(input)}}}if(isValid){var btn=this.form.querySelector('[type="submit"]');var reset=function(){};if(btn){var originalHtml=btn.innerHTML;var loadingHtml=this.options.submitButtonLoading;if(loadingHtml){btn.innerHTML=loadingHtml}btn.disabled=true;reset=function(){btn.disabled=false;btn.innerHTML=originalHtml}}if(typeof this.options.onValid==="function"){this.options.onValid(e,this.form,values,reset)}}else{e.preventDefault();e.stopPropagation();if(typeof this.options.onInvalid==="function"){this.options.onInvalid(errors)}}};BS5FormValidator.prototype.showError=function(input,message){input.classList.add("is-invalid");input.classList.remove("is-valid");var feedback=input.parentNode.querySelector(".invalid-feedback");if(!feedback){feedback=document.createElement("div");feedback.className="invalid-feedback";input.parentNode.appendChild(feedback)}feedback.textContent=message};BS5FormValidator.prototype.clearError=function(input){input.classList.remove("is-invalid");input.classList.add("is-valid")};window.BS5FormValidator=BS5FormValidator})(window);